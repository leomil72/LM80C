10 REM       O T H E L L O
20 REM
30 REM  FIRST APPEARED ON PERSONAL SOFTWARE
35 REM  MAGAZINE, ISSUES 17/18, FOR ZX81
40 REM  ADAPTED FOR LM80C BASIC
45 REM  BY LEONARDO MILIANI FROM A SOURCE
50 REM  LIST FOR COMMODORE 16 IN TURN
60 REM  ADAPTED BY A. MOTTA AND PUBLISHED
70 REM  ON SUPERCOMMODORE #4 MAGAZINE
90 REM
100 REM
102 REM INITIALIZING VARIABLES
103 REM
100 GOSUB 8000
110 PRINT:PRINT TAB(10);"R E V E R S I":PRINT:GOSUB 9000
115 DIM AP(99),BP(7),CP(99),DP(99)
120 RESTORE 10000:FOR I=0 TO 7:READ BP(I):NEXT
130 FOR I=1 TO 4:FOR J=1 TO 8:READ X:Y=I*10+J
140 AP(Y)=X:AP((4-I)*20+Y+10)=X:NEXT:NEXT
200 REM
201 REM START OF GAME
202 REM
210 FOR I=0 TO 99:CP(I)=0:NEXT
220 FOR I=0 TO 9:CP(I)=9:CP(I+90)=9:NEXT
230 FOR I=1 TO 8:CP(I*10)=9:CP(I*10+9)=9:NEXT
240 CP(44)=1:CP(45)=15:CP(54)=15:CP(55)=1:G=2:C=2:PG=1:PC=1
250 REM
260 LOCATE 0,3:PRINT "Black moves first."
265 LOCATE 0,4:PRINT SPC(32);:LOCATE 0,4
267 PRINT "Choose color (B/W) ";:Z=INKEY(0)
270 Z=INKEY(10) AND 223:IF Z<>ASC("B") AND Z<>ASC("W") THEN 270
280 IF Z=ASC("W") THEN PG=15:PRINT "W":ELSE PC=15:PRINT "B"
290 LOCATE 0,6:PRINT SPC(32);
292 LOCATE 0,6:PRINT "Game level (1/2) ";:Z=INKEY(0)
295 Z=INKEY(10):IF Z<>ASC("1") AND Z<>ASC("2") THEN 295
296 LV=Z-48:PRINT CHR$(Z):PAUSE 10
300 CLS:LOCATE 0,2:PRINT "REVERSI"
305 LOCATE 0,3:FOR I=0 TO 6:PRINT CHR$(166);:NEXT
310 LOCATE 13,0:PRINT "1 2 3 4 5 6 7 8"
312 LOCATE 12,1:PRINT CHR$(135);
314 FOR I=1 TO 7:PRINT CHR$(143);CHR$(141);:NEXT:PRINT CHR$(143);CHR$(136)
320 FOR I=0 TO 7:LOCATE 11,2+I*2:PRINT CHR$(65+I);
325 FOR L=1 TO 8:PRINT CHR$(144);" ";:NEXT L:PRINT CHR$(144);CHR$(65+I)
328 IF I=7 THEN 334
330 LOCATE 12,2+I*2+1:PRINT CHR$(140);
332 FOR L=1 TO 7:PRINT CHR$(143);CHR$(134);:NEXT L:PRINT CHR$(143);CHR$(142)
334 NEXT
340 LOCATE 12,17:PRINT CHR$(138);
342 FOR I=1 TO 7:PRINT CHR$(143);CHR$(139);:NEXT:PRINT CHR$(143);CHR$(137)
350 LOCATE 13,18:PRINT"1 2 3 4 5 6 7 8"
355 LOCATE 19,8:PRINT CHR$(192);:LOCATE 21,8:PRINT CHR$(160);
360 LOCATE 19,10:PRINT CHR$(160);:LOCATE 21,10:PRINT CHR$(192);
362 TC=192:IF PC=15 THEN TC=160
364 TG=192:IF PG=15 THEN TG=160
370 LOCATE 0,8:PRINT "CPU ";CHR$(TC);" =";C
375 LOCATE 0,10:PRINT "You ";CHR$(TG);" =";G
380 LOCATE 0,14:PRINT"Level";LV
900 IF PG=15 THEN 2000
1000 REM
1002 REM PLAYER'S MOVE
1003 REM
1005 FOR I=0 TO 1:SOUND 3,3750,0:PAUSE 10:SOUND 3,3850,0:PAUSE 10:NEXT
1007 SOUND 3,0,1
1010 LOCATE 0,20:PRINT SPC(32);
1012 LOCATE 0,20:INPUT "Your move (e.g. A1)";ZZ$:GOSUB 9100
1015 IF LEN(ZZ$)<>2 THEN 1005
1017 Z$=LEFT$(ZZ$,1):S$=RIGHT$(ZZ$,1)
1020 IF Z$<"A" OR Z$>"H" THEN 1005
1030 S=(ASC(Z$)-64)*10
1040 IF S$<"1" OR S$>"8" THEN 1005
1050 S=S+ASC(S$)-48:PA=PC:PP=PG:M=0
1070 LOCATE 0,20:PRINT SPC(32);:GOSUB 7000:IF M<>O THEN 1100
1080 LOCATE 0,20:PRINT "Illegal move - Repeat";SPC(11);
1090 FOR I=4000 TO 3700 STEP -25:SOUND 3,I,0:PAUSE 5:NEXT:SOUND 3,0,1
1095 GOSUB 6900:GOTO 1005
1100 P=S:N=1:GOSUB 6800:GOSUB 6900:GOSUB 6000
1110 C=C-N+1:G=G+N:IF C+G=64 THEN 4000
1120 GOSUB 6700
2000 REM
2002 REM CPU'S MOVE
2003 REM
2010 PP=PC:PA=PG:LOCATE 0,20
2012 PRINT "Thinking about my move...       ";
2015 FOR I=3650 TO 3850 STEP 50:SOUND 3,I,0:PAUSE 5:NEXT:SOUND 3,0,1
2030 ONLVGOSUB 2500,3000
2040 IF Q<>O THEN 2100
2050 LOCATE 0,20:PRINT "Pass my roll";SPC(20);
2060 FOR I=4000 TO 3700 STEP -25:SOUND 3,I,0:PAUSE 5:NEXT:SOUND 3,0,1
2070 GOSUB 6900:GOTO 2200
2100 LOCATE 0,20:PRINT "My move is ";
2110 PRINT CHR$(INT(Q/10)+64);CHR$(Q-INT(Q/10)*10+48);SPC(19);
2115 FOR I=3700 TO 3950 STEP 50:SOUND 3,I,0:PAUSE 5:NEXT:SOUND 3,0,1
2120 S=Q:P=Q:N=1:GOSUB 6800:GOSUB 6900:GOSUB 6000
2130 C=C+N:G=G-N+1:GOSUB 6700:IF C+G=64 THEN 4000
2200 REM
2202 REM CHECK IF PLAYER CAN MOVE
2203 REM
2210 M=0:PP=PG:PA=PC:FOR S=11 TO 88:GOSUB 7000:IF M<>0 THEN 2400
2215 NEXT:IF Q=0 THEN 4000
2220 LOCATE 0,20:PRINT "Pass your roll";SPC(18);
2225 SOUND 3,3000,0:PAUSE 60:SOUND 3,0,1
2230 GOSUB 6900:GOTO 2000
2400 GOTO 1000
2500 REM
2502 REM CPU MOVE AT LEVEL 1
2503 REM
2520 Q=0:FOR S=11 TO 88:IF CP(S)<>0 THEN 2590
2530 IF AP(S)<AP(Q) THEN 2590
2560 M=0:GOSUB 7010
2570 IF AP(M)=AP(Q) AND RND(1)<.5 THEN Q=M
2580 IF AP(M)>AP(Q) THEN Q=M
2590 NEXT:RETURN
3000 REM
3002 REM CPU MOVE AT LEVEL 2
3003 REM
3010 FOR I=11 TO 88:DP(I)=CP(I):NEXT
3020 Q2=-9:PM=0:FOR K=11 TO 88:IF CP(K)<>O THEN 3130
3030 S=K:M=0:GOSUB 7010:IF M=0 THEN 3130
3050 FOR I=0 TO 7:P=M+BP(I):IF CP(P)<>PA THEN 3100
3060 P=P+BP(I):IF CP(P)=PA THEN 3060
3070 IF CP(P)<>PP THEN 3100
3080 P=P-BP(I):CP(P)=PP:IF P=M THEN 3100
3090 GOTO 3080
3100 NEXT:M1=M:PA=PC:PP=PG:Q=0:GOSUB 2500
3105 IF Q=0 THEN 3140
3110 M=AP(M1)-AP(Q):IF M>Q2 THEN Q2=M:PM=M1
3120 FOR I=11 TO 88:CP(I)=DP(I):NEXT
3130 PP=PC:PA=PG:NEXT:Q=PM:RETURN
3140 FOR I=11 TO 88:CP(I)=DP(I):NEXT
3150 PP=PC:PA=PG:Q=M1:RETURN
4000 REM
4002 REM END OF GAME
4003 REM
4004 LOCATE 0,20
4020 IF G>C THEN PRINT "Good - You WIN !";SPC(48);
4030 IF C=G THEN PRINT "Tie Game...";SPC(53);
4040 IF C>G THEN PRINT "I   W I N !!!";SPC(51);
4050 RESTORE 10200
4055 READ X,Y:SOUND 3,X,0:PAUSE Y
4060 IF X<>0 THEN 4055
4065 SOUND 3,0,1:GOSUB 6900
4070 LOCATE 0,20:PRINT SPC(32);:PRINT "Another game (Y/N)?":Z=INKEY(0)
4080 Z=INKEY(10) AND 223:IF Z=ASC("Y") THEN CLS:GOTO 200
4090 IF Z<>ASC("N") THEN 4070
4100 CLS:PRINT "B y e !":END
4500 LOCATE 0,20:PRINT "I   W I N !!!";SPC(19);
6000 REM
6002 REM BOARD UPGRADE
6003 REM
6010 FOR I=0 TO 7:P=S+BP(I):IF CP(P)<>PA THEN 6100
6020 P=P+BP(I):IF CP(P)=PA THEN 6020
6030 IF CP(P)<>PP THEN 6100
6040 P=P-BP(I):IF P=S THEN 6100
6050 GOSUB 6800:CP(P)=PP:N=N+1:GOTO 6040
6100 NEXT:CP(S)=PP:RETURN
6700 LOCATE 7,8:PRINT C:LOCATE 7,10:PRINT G:RETURN
6800 X=INT(P/10):Y=P-(X*10):LOCATE 11+(2*Y),2*X
6810 IF PP=1 THEN PRINT CHR$(192);:GOTO 6830
6820 PRINT CHR$(160);
6830 RETURN
6900 PAUSE 50:RETURN
7000 REM
7002 REM CHECK FOR LEGAL MOVE
7003 REM
7006 IF CP(S)<>0 THEN RETURN
7010 FOR I=0 TO 7:P=S+BP(I):IF CP(P)<>PA THEN 7050
7020 P=P+BP(I):IF CP(P)=PA THEN 7020
7030 IF CP(P)<>PP THEN 7050
7040 M=S:RETURN
7050 NEXT:RETURN
8000 REM
8020 REM INITIALIZE SCREEN AND STARTING MUSIC
8030 REM
8050 VOLUME 0,15:SCREEN 1:VREG 7,34:FOR I=0 TO 31:VPOKE 8192+I,242:NEXT
8060 RESTORE 10300:FOR I=0 TO 7:READ X:VPOKE 1280+I,X:VPOKE 1536+I,X:NEXT
8070 VPOKE 8216,18
8080 RETURN
9000 RESTORE 10100
9010 READ X,Y:IF X=0 THEN SOUND 3,0,1:RETURN
9020 SOUND 3,X,0:PAUSE Y
9030 GOTO 9010
9099 REM CONVERT A STRING INTO CAPITAL LETTERS
9100 IF ZZ$="" THEN RETURN:ELSE ZA$="":FOR I=1 TO LEN(ZZ$)
9110 ZB$=MID$(ZZ$,I,1)
9120 IF ZB$>="a" AND ZB$<="h" THEN ZB$=CHR$(ASC(MID$(ZZ$,I,1)) AND 223)
9130 ZA$=ZA$+ZB$
9140 NEXT:ZZ$=ZA$:RETURN
10000 REM
10002 REM DATA
10003 REM
10010 DATA -11,-10,-9,-1,1,9,10,11
10020 DATA 9,2,8,6,6,8,2,9
10030 DATA 2,1,3,4,4,3,1,2
10040 DATA 8,3,7,5,5,7,3,8
10050 DATA 6,4,5,0,0,5,4,6
10100 DATA 3834,14,3798,14,3834,28,4015,1,3834,14,3798,14,3834,28
10110 DATA 3854,14,3834,14,3810,14,3798,14,3770,14,3798,14,3810,14
10120 DATA 3798,7,3810,7,3834,14,3739,14,4015,1,3739,28,4015,1
10130 DATA 3739,7,3770,7,3798,7,3810,7,3834,2,3854,14,3770,14
10140 DATA 4015,1,3770,14,3810,14,3798,14,3770,14,3739,28,0,0
10200 DATA 3881,16,3854,16,3810,16,4015,1,3810,8,4015,1,3810,16
10210 DATA 3739,16,3854,16,3834,32,3739,16,3854,16,3834,32,3739,16
10220 DATA 3834,16,3810,32,3881,16,3854,16,3810,16,4015,1,3810,8
10230 DATA 4015,1,3810,8,3739,16,3854,16,3834,32,3739,16,3854,16
10240 DATA 3834,16,3739,16,3810,40,3810,8,0,0
10300 DATA 60,126,255,255,255,255,126,60
