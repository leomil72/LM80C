10 CLS:CLEAR 2000:A=RND(-ABS(TMR(0))):TI=1:VOLUME 0,15
12 DIM NE(5,12),NT$(12):RESTORE 55900
14 FOR I=1 TO 5:FOR J=1 TO 12:READ NE(I,J):NEXT J,I
16 FOR I=1 TO 12:READ NT$(I):NEXT:GOSUB 40000
20 X=2:Y=2:LO=1:D1=1
22 DEF FNRN(X)=INT((RND(1)*X)+1)
24 DIM BB(3),W$(18)
26 DIM M$(12),MS(12),N1(12):RESTORE 50010
28 FOR I=1 TO 12:READ M$(I),MS(I),N1(I):NEXT I
30 FOR I=1 TO 18:READ W$(I):NEXT I
33 FOR I=1 TO 9:READ L$(I):NEXT I
36 FOR I=1 TO 10:READ KL$(I):NEXT I
40 FOR I=1 TO FNRN(5):READ BE,BF,BG:NEXT I
50 GOTO 80
60 IF SE=1 THEN 80
65 CLS:COLOR 15,13,13
70 LOCATE 3,10:PRINT "Map comes with experience";
75 PAUSE 200:GOTO 1000
80 IF SE=0 THEN 1000
100 SCREEN 2:COLOR 11,2,2
102 REM **BORDERS**
105 DRAW 64,48,191,48:DRAW 191,48,191,143:DRAW 191,143,64,143:DRAW 64,143,64,48
109 REM **RIVER**
110 CO=4:ZA$="BM0,48;E7R4E3U4E3R3E4U4R4D4G6L3G2D5G2L1G2L4G8U4"
120 GOSUB 53000
129 REM **CAVE**
130 CO=11:ZA$="BM71,80;R4E4R1E3R2E1R2F1R2F7R2L2BL8L10E3R4F3"
135 GOSUB 53000
149 REM **LAKE**
150 CO=4:ZA$="BM152,45;E8U4E5R5F2D1F3D4G2D1F4D1G5L4G2L12H1"
152 ZA$=ZA$+"L2H1L1H3U1E2R4BR5E5R5D3F2G3L5U1H2L2"
155 GOSUB 53000
169 REM **S-BARRIER**
170 CO=6:ZA$="BM96,132;U6R6U6R6U6R6U6R6U6R6D3L3D6L6D6L6D6L6D6L6D3L3"
175 GOSUB 53000
189 REM **MOUNTAINS**
190 CO=11:ZA$="BM80,40;E10F8H4E8F6G3E5F4":GOSUB 53000
210 ZA$="BM74,65;E8H3G3E4F2E7F10H5G5F5H8G2":GOSUB 53000
229 REM **CASTLE**
230 ZA$="BM174,156;U12L3E2U2R3D2R3U2R3D2R3U2R3D2F2L3"
232 ZA$=ZA$+"D6R3D2R3U2R3D2R3U2R3D2R3U2R3U23L3E2U2R3"
234 ZA$=ZA$+"D2R3U2R1BD33L31U4H3L1G3D4L2NR10L6G3D1R49BU3"
240 GOSUB 53000
249 REM **TOWER**
250 ZA$="BM52,148;U22R10D4BL3H1L2G1D1F1R2E1U1BR3D18L10"
255 GOSUB 53000
279 REM **VILLAGE**
280 CO=9:ZA$="BM76,165;U4L1E3F3L1D4L4":GOSUB 53000
290 ZA$="BM90,170;U4L1E3F3L1D4L4":GOSUB 53000
300 ZA$="BM80,178;U4L1E3F3L1D4L4":GOSUB 53000
310 ZA$="BM64,184;U4L1E3F3L1D4L4":GOSUB 53000
330 ZA$="BM92,186;U4L1E3F3L1D4L4":GOSUB 53000
349 REM **FOREST**
350 CO=12:ZA$="BM10,78;U7NG3NF3U3NG3NF3U1":GOSUB 53000
360 ZA$="BM10,108;U7NG3NF3U3NG3NF3U1":GOSUB 53000
370 ZA$="BM32,68;U7NG3NF3U3NG3NF3U1":GOSUB 53000
380 ZA$="BM32,96;U7NG3NF3U3NG3NF3U1":GOSUB 53000
400 ZA$="BM50,72;U7NG3NF3U3NG3NF3U1":GOSUB 53000
410 ZA$="BM68,24;U7NG3NF3U3NG3NF3U1":GOSUB 53000
420 ZA$="BM68,50;U7NG3NF3U3NG3NF3U1":GOSUB 53000
460 PAINT 65,72,4
470 PAINT 140,76,4
480 PAINT 113,113,6
490 PAINT 154,116,11
500 REM PAINT 188,150,6
510 PAINT 153,128,4
530 PAINT 103,129,9
540 PAINT 110,132,9
550 PAINT 105,136,9
560 PAINT 97,139,9
570 PAINT 111,138,9
580 PAINT 95,107,11
590 REM PAINT 62,114,6
600 PAINT 112,87,6
620 SX=X:SY=Y:GOSUB 55000
650 PAUSE 300
660 SCREEN 1
1000 CLS:COLOR 15,12,1
1010 LOCATE 0,0:PRINT "What now, Pendragon?";:LOCATE 0,2:PRINT "1.Proceed";
1004 LOCATE 0,4: PRINT "2.Rest";:LOCATE 0,6:PRINT "3.Status";
1006 LOCATE 0,8: PRINT "4.Map";
1015 LOCATE 0,12:PRINT "Enter: 1/2/3/4";
1020 C=INKEY(10):IF C=0 THEN 1020
1030 IF C=ASC("1") THEN 2000
1040 IF C=ASC("2") THEN 3000
1050 IF C=ASC("3") THEN 10000
1060 IF C=ASC("4") THEN 60
1080 GOTO 1020
2000 CLS:COLOR 3,4,4:GOTO 9000
2001 LOCATE 12,1:PRINT "PROCEED";:LOCATE 13,5:PRINT "North";:LOCATE 8,7:PRINT "West";
2002 LOCATE 19,7:PRINT "East";:LOCATE 13,9:PRINT "South";:LOCATE 13,12:PRINT "Halt";
2003 A=INKEY(10) AND 223:IF A=0 THEN 2003
2004 IF A=ASC("N") THEN 2020
2005 IF A=ASC("S") THEN 2030
2006 IF A=ASC("W") THEN 2050
2007 IF A=ASC("E") THEN 2040
2008 IF A=ASC("H") THEN 1000
2009 GOTO 2003
2010 INPUT A$
2020 Y=Y-16:LO=LO-16:IF Y<2 THEN Y=2:LO=LO+16
2025 GOTO 2065
2030 Y=Y+16:LO=LO+16:IF Y>164 THEN Y=164:LO=LO-16
2035 GOTO 2065
2040 X=X+16:LO=LO+1:IF X>252 THEN X=252:LO=LO-1
2045 GOTO 2065
2050 X=X-16:LO=LO-1:IF X<2 THEN X=2:LO=LO+1
2065 LX=0
2066 M=M+1:BF=BF-1:BD=BD+2
2071 GOTO 2900
2075 IF LO=3 OR LO=18 OR LO=33 OR LO=34 THEN LX=1:GOTO 30000
2076 IF LO=5 OR LO=21 OR LO=37 OR LO=49 OR LO=50 THEN LX=2:GOTO 30000
2077 IF LO=51 OR LO=52 OR LO=65 OR LO=66 OR LO=67 THEN LX=2:GOTO 30000
2078 IF LO=81 OR LO=82 OR LO=83 OR LO=97 THEN LX=2:GOTO 30000
2079 IF LO=8 OR LO=22 OR LO=23 OR LO=24 OR LO=25 THEN LX=3:GOTO 30000
2080 IF LO=38 OR LO=39 OR LO=40 OR LO=54 OR LO=55 THEN LX=3:GOTO 30000
2081 IF LO=70 OR LO=71 THEN LX=4:GOTO 30000
2082 IF LO=12 OR LO=27 OR LO=28 OR LO=29 OR LO=41 THEN LX=5:GOTO 30000
2083 IF LO=43 OR LO=44 OR LO=45 OR LO=57 OR LO=58 THEN LX=5:GOTO 30000
2084 IF LO=59 OR LO=60 THEN LX=5:GOTO 30000
2085 IF LO=75 OR LO=90 OR LO=91 OR LO=104 OR LO=105 THEN LX=9:GOTO 30000
2086 IF LO=106 OR LO=119 OR LO=120 THEN LX=9:GOTO 30000
2087 IF LO=100 OR LO=101 OR LO=116 OR LO=117 THEN LX=6:GOTO 30000
2088 IF LO=132 OR LO=133 THEN LX=6:GOTO 30000
2089 IF LO=148 OR LO=149 OR LO=150 OR LO=165 THEN LX=7:GOTO 30000
2090 IF LO=166 OR LO=167 THEN LX=7:GOTO 30000
2091 IF LO=123 OR LO=124 OR LO=125 OR LO=139 THEN LX=8:GOTO 30000
2092 IF LO=140 OR LO=141 OR LO=142 OR LO=143 THEN LX=8:GOTO 30000
2093 IF LO=144 OR LO=155 OR LO=156 OR LO=157 THEN LX=8:GOTO 30000
2094 IF LO=158 OR LO=159 OR LO=160 THEN LX=8:GOTO 30000
2095 IF LX>0 THEN 30000
2100 GOTO 2000
2900 RF=RND(TI)
2910 IF RF>0.75 THEN 24999
2920 IF RF<0.45 THEN 20000
2930 LOCATE 7,15:PRINT "Nothing. Continue";
2940 PAUSE 200
2950 GOTO 2075
3000 GOTO 9200
3002 GOTO 3100
3004 RE=0
3005 CLS:COLOR 15,1,1
3006 FOR N=1 TO 25
3007 LOCATE INT(RND(TI)*32),INT(RND(TI)*24):PRINT"Z";
3008 NEXT N
3010 BE=BE+FNRN(10)
3030 BF=BF+FNRN(10)
3040 BH=BH-FNRN(10):IF BH<=0 THEN BH=0
3045 IF BE>=75 THEN BE=75
3050 IF BF>=75 THEN BF=75
3055 DU=DU+INT(RE/2):DV=DV+RE
3060 FOR N=1 TO 20:SOUND 1,3900,10:PAUSE 11
3070 NEXT N
3080 CLS
3090 GOTO 1000
3100 RE=FNRN(100)
3110 IF RE>40 THEN 3150
3120 GOTO 3004
3150 CLS:COLOR 2,1,1
3155 LOCATE 5,0
3160 PRINT "The Forces of evil are too close";:LOCATE 9,7
3165 PRINT "No time to rest";
3170 PAUSE 200
3180 GOTO 1000
4000 SCREEN 1:COLOR 2,1,1
4010 LOCATE 14,5:PRINT "At";
4020 LOCATE (32-LEN(L$(LX)))#2,7:PRINT L$(LX);
4200 LOCATE 10,15:PRINT "Press <P>";
4202 GOSUB 20700
4210 GOTO 2000
6000 CLS:COLOR 15,8,8:LOCATE 9,2
6010 PRINT "You have been";:LOCATE 12,4:PRINT "ATTACKED";
6020 IF N1>=1 AND RND(TI)<0.5 THEN
6030 ZB=ZB-2:IF ZB<=0 THEN 25480
6040 RF=FNRN(10)
6050 ON RF GOTO 6060,6070,6080,6090,6100,6110,6120,6130
6060 LOCATE 6,7:PRINT "It swings and misses";:GOTO 6190
6070 LOCATE 5,7:PRINT "You deflect the blow";:GOTO 6190
6080 LOCATE 10,7:PRINT "But hesitates";:GOTO 6190
6090 LOCATE 11,7:PRINT "A body blow";:DX=5:GOTO 6190
6100 LOCATE 9,7:PRINT "A head wound";:DX=8:GOTO 6190
6110 LOCATE 9,7:PRINT "A chest wound";:DX=6:GOTO 6190
6120 LOCATE 10,7:PRINT "A blow to arm";:DX=4:GOTO 6190
6130 LOCATE 11,7:PRINT "A body blow";:DX=3:GOTO 6190
6140 LOCATE 12,7:PRINT "Legs hit";
6150 IF RND(TI)<0.5 THEN 6180
6160 DX=5
6180 LOCATE 8,7:PRINT "Saved by armour!";
6190 BE=BE-DX:BF=BF-INT(DX/2)
6195 IF BE<=0 THEN 7000
6196 IF BF<=0 THEN 7000
6198 PAUSE 200
6200 GOTO 25210
7000 CLS:COLOR 15,2,2
7020 IF DI=1 THEN 8600
7025 LOCATE 0,0:PRINT "*Life has fled your mortal body*";
7030 LOCATE 6,3:PRINT "Such an incompetent";:LOCATE 9,5:PRINT "was not worthy";
7035 LOCATE 10,7:PRINT "of the name";:LOCATE 11,9:PRINT "PENDRAGON";
7040 GOSUB 7200:REM PLAY FUNERAL MARCH
7045 FOR N=1 TO 8:LOCATE 31,0:PRINT CHR$(13):NEXT N
7050 LOCATE 9,9:PRINT "How you rated"
7055 LOCATE 9,10:PRINT "Experience:";BD:PRINT "Gold:";BH
7080 RA=INT(((BD*(BH+1))+(DI*5)+(DG*8)+(DD*10))/(M/10))
7085 LOCATE 10,11:PRINT "Your rating:";RA
7090 PAUSE 100:LOCATE 4,13
7100 PRINT "If you had the chance of";:LOCATE 9,14:PRINT "reincarnation";:LOCATE 2,15
7101 PRINT "would you like to try again";:LOCATE 11,16:PRINT "Yes or No";
7110 A=INKEY(10) AND 223:IF A=0 THEN 7110
7120 IF A=ASC("Y") THEN 7140
7130 GOTO 7110
7140 RUN
7200 ZA$="O1V31T2L4GGL8GGL4B-AAGGF+G":GOSUB 56000
7210 RETURN
8000 IF WA=1 THEN 2000
8010 CLS:COLOR 1,9,9:OM=0
8030 IF DD=1 THEN 8070
8040 LOCATE 7,1:PRINT "You will need the";:LOCATE 8,3:PRINT "Necromancers maps";
8050 PAUSE 200
8060 GOTO 2000
8070 IF DG=1 THEN 8105
8080 LOCATE 7,1:PRINT "You will need the";:LOCATE 9,3:PRINT "Ring of power";
8090 PAUSE 200
8100 GOTO 2000
8105 OM=FNRN(20)
8110 LOCATE 3,6:PRINT "The Water of Life awaits";
8115 LOCATE 4,7:PRINT "What is the magic word";
8120 GOSUB 51000
8130 IF SP=1 THEN 8190
8140 CLS:COLOR 1,13,13
8145 LOCATE 11,7:PRINT "You failed";
8150 PAUSE 100
8160 GOTO 2000
8190 CLS:COLOR 1,3,3:WA=1
8200 LOCATE 12,3:PRINT "You have";:LOCATE 8,5:PRINT "The Water of Life";
8220 PAUSE 200
8230 GOTO 2000
8300 IF DG=1 THEN 2000
8305 CLS:COLOR 1,9,9:LOCATE 9,1:PRINT "At Cave of Doom";
8310 LOCATE 6,2:PRINT "Do you wish to enter";:LOCATE 13,3:PRINT "Yes/No?";
8312 A=INKEY(10) AND 223:IF A=0 THEN 8312
8313 IF A=ASC("Y") THEN 8317
8314 IF A=ASC("N") THEN 30420
8315 GOTO 8312
8317 IF CB=1 THEN 8320
8318 LOCATE 4,8:PRINT "No use. You have no lamp";
8319 GOTO 30420
8320 RF=FNRN(3)
8330 ON RF GOTO 8340,8360,8360
8340 CLS:COLOR 1,9,9
8350 GOTO 20500
8360 LOCATE 6,8:PRINT "Something evil here";
8365 LOCATE 3,9:PRINT "draining your magic powers";
8370 BG=BG-INT(BG/10)
8380 GOTO 30420
8400 CLS:COLOR 1,9,9
8405 IF DI=1 THEN 2000
8410 LOCATE 12,1:PRINT "At Lake";:LOCATE 8,2:PRINT "Do you wish to cross";
8012 LOCATE 9,3:PRINT "to the island?";:LOCATE 12,4:PRINT "Yes/No?";
8415 A=INKEY(10) AND 223:IF A=0 THEN 8415
8420 IF A=ASC("Y") THEN 8435
8425 IF A=ASC("N") THEN 30520
8430 GOTO 8415
8435 IF CL=1 THEN 8450
8440 LOCATE 4,9:PRINT "No use. You have no boat";
8445 GOTO 30520
8450 RF=FNRN(3)
8455 ON RF GOTO 8460,8470,8470
8460 CLS:COLOR 1,9,9
8465 GOTO 20475
8470 GOTO 8360
8500 IF DD=1 THEN 2000
8505 CLS:COLOR 1,9,9
8510 LOCATE 6,1:PRINT "At Tower of the Eye";:LOCATE 6,2:PRINT "Do you wish to enter";
8512 LOCATE 12,3:PRINT "Yes/No?";
8515 A=INKEY(10) AND 223:IF A=0 THEN 8515
8520 IF A=ASC("Y") THEN 8535
8525 IF A=ASC("N") THEN 30665
8530 GOTO 8515
8535 IF CM=1 OR CA=1 THEN 8550
8540 LOCATE 6,9:PRINT "No use. You have no";:LOCATE 14,10:PRINT "rope";
8545 GOTO 30665
8550 RF=FNRN(3)
8555 ON RF GOTO 8560,8570,8570
8560 CLS:COLOR 1,9,9
8565 GOTO 20525
8570 GOTO 8360
8600 CLS:FOR N=2 TO 9
8610 COLOR 15,N,N
8615 FOR M=1 TO 20
8620 OO$="O3L2GBO4CDL4CO3BAG"
8621 NEXT M
8624 ZA$="T255V10"+OO$:GOSUB 56000:ZA$="T255V20"+OO$:GOSUB 56000
8626 ZA$="T255V30"+OO$:GOSUB 56000
8630 NEXT N
8640 LOCATE 8,0:PRINT "The Shield of Life";:LOCATE 11,1:PRINT "saved you";
8645 LOCATE 2,5:PRINT "Magic all gone and very weak";
8650 BE=20:BF=20:BG=0:DI=0
8655 PAUSE 400
8660 GOTO 2000
9000 IF BE<=0 THEN 7000
9010 IF BF<=0 THEN 9100
9015 IF WA=1 AND LO=1 THEN 9300
9016 IF WA=1 AND LO=2 THEN 9300
9017 IF WA=1 AND LO=17 THEN 9300
9030 IF BD>10 THEN SE=1
9040 GOTO 2001
9100 CLS:COLOR 15,4,4
9110 LOCATE 7,7:PRINT "You are too weak";
9115 LOCATE 6,8:LOCATE 6,8:PRINT "Rest and recuperate";
9120 PAUSE 200
9130 GOTO 1000
9200 CLS:COLOR 1,15,5
9202 IF BH<=0 THEN 9230
9204 GOTO 3002
9230 LOCATE 8,7:PRINT "No gold-No rest";
9240 PAUSE 200
9260 IF BF<=0 THEN 7000
9270 GOTO 1000
9280 RETURN
9300 CLS:COLOR 15,8,8
9310 FOR N=1 TO 100
9320 ZA$="T255AC":GOSUB 56000
9330 NEXT N
9340 LOCATE 2,2:PRINT "You are PENDRAGON The Mighty";
9350 LOCATE 10,4:PRINT "You have WON";
9360 LOCATE 0,7:PRINT ,"  Experience:";BD
9365 LOCATE 11,8:PRINT "Gold:";BH;
9370 RA=INT(((BD*(BH+1))+(DI*5)+(DG*8)+(DD*10)+(WA*500))/(M/10))
9380 LOCATE 8,11:PRINT "Your rating:"RA;
9390 GOTO 9390
10000 CLS:COLOR 2,1,1
10050 IF BE<0 THEN BE=0
10055 IF BF<0 THEN BF=0
10100 LOCATE 10,0:PRINT "<PENDRAGON>";:LOCATE 10,2:PRINT "Power status";:
10110 LOCATE 0,4:PRINT "Experience:  ";BD:LOCATE 0,5:PRINT "Health    :  ";BE
10115 LOCATE 0,6:PRINT "Strenght  :  ";BF:LOCATE 0,7:PRINT "Magic         ":
10117 LOCATE 0,8:PRINT "Powers    :  ";BG:
10120 LOCATE 0,9:PRINT "Gold      :  ";BH
10130 LOCATE 5,13:PRINT "See inventory? Yes/No?";
10145 C=INKEY(10) AND 223:IF C=10 THEN 10145
10150 IF C=ASC("N") THEN 1000
10160 IF C=ASC("Y") THEN 10170
10165 GOTO 10145
10170 CLS:COLOR 1,11,11
10175 IF BG<=0 THEN DH=0
10180 LOCATE 10,0:PRINT "Possessions:";:LOCATE 5,2:PRINT "Rope :";CA;
10190 LOCATE 5,3:PRINT "Lamp :";CB;:LOCATE 5,4:PRINT "Boat :";CL;
10200 LOCATE 5,8:PRINT "Cloak of Invisibility:";DF;
10210 LOCATE 5,9:PRINT "Precious stones      :";GP;
10220 LOCATE 5,10:PRINT "Necromancers map     :";DD;
10230 LOCATE 5,11:PRINT "Ring of power        :";DG;
10240 LOCATE 5,12:PRINT "Shield of life       :";DI;
10250 LOCATE 5,13:PRINT "Power stones         :";DH;
10260 LOCATE 10,15:PRINT "Press ENTER";
10270 A=INKEY(10):IF A=0 THEN 10270
10280 IF A=13 THEN 1000
10290 GOTO 10270
20000 TX=0
20030 RF=INT(RND(TI)*13+1)
20040 CLS:COLOR 15,13,13
20050 LOCATE 9,2:PRINT "Something here";:LOCATE 9,4:PRINT "Do you search?";
20055 LOCATE 13,6:PRINT "Yes/No";
20060 A=INKEY(10) AND 223:IF A=0 THEN 20060
20070 IF A=ASC("Y") THEN 20090
20080 IF A=ASC("N") THEN 2075
20085 GOTO 20060
20090 CLS:COLOR 1,15,5:IF RF>10 THEN RF=RF-10:GOTO 20105
20100 ON RF GOTO 20300,20110,20130,20150,20180,20210,20285,20300,20320,20340
20105 ON RF GOTO 20360,20455,20375
20110 LOCATE 11,6:PRINT "Water here";:LOCATE 6,8:PRINT "You drink your fill";
20120 DE=FNRN(15):BE=BE+DE:IF BE>75 THEN BE=75
20122 GOSUB 20750
20125 GOTO 21050
20130 LOCATE 13,6:PRINT "Food";:LOCATE 9,10:PRINT "Eat your fill";
20140 OD=FNRN(15):BF=BF+OD:IF BF>75 THEN BF=75
20142 GOSUB 20750
20145 GOTO 21050
20150 LOCATE 13,3:PRINT "A Rope";
20160 GOSUB 21000
20165 IF NO=1 THEN 2075
20170 CA=CA+TX:IF CA>1 THEN CA=1
20175 GOTO 21050
20180 LOCATE 13,3:PRINT "A Lamp";
20190 GOSUB 21000
20195 IF NO=1 THEN 2075
20200 CB=CB+TX:IF CB>1 THEN CB=1
20205 GOTO 20150
20210 LOCATE 13,3:PRINT "A Boat";
20215 GOSUB 21000
20217 IF NO=1 THEN 2075
20220 CL=CL+TX:IF CL>1 THEN CL=1
20225 GOTO 21050
20285 G=INT(RND(TI)*20)+1
20287 LOCATE 6,3:PRINT G;"Precious stones";
20290 GOSUB 21000
20291 IF NO=1 THEN 2075
20292 GP=GP+(G*TX)
20295 GOTO 21050
20300 LD=INT(RND(TI)*30)+2
20305 LOCATE 4,3:PRINT "A cache of";LD;"gold pieces";
20310 GOSUB 21000
20311 IF NO=1 THEN 2075
20315 BH=BH+(LD*TX):GOTO 21050
20320 DV=INT(RND(TI)*7+3)
20325 LOCATE 8,3:PRINT DV;" Power stones";
20330 GOSUB 21000
20331 IF NO=1 THEN 2075
20335 DH=DH+(DV*TX):BG=BG+((DV*TX)*RND(5)):GOTO 21050
20340 LOCATE 5,3:PRINT "A place of evil power";
20345 BG=BG-FNRN(10):IF BG<=0 THEN BG=0
20347 GOSUB 20750
20350 GOTO 21050
20360 LOCATE 12,3:PRINT "A Trap";:LOCATE 3,6:PRINT "Escaping has weakened you!";
20365 BF=BF-FNRN(7):IF BF<=0 THEN BF=0
20367 GOSUB 20750
20370 GOTO 21050
20375 LOCATE 11,3:PRINT "An Ambush!";:LOCATE 3,5:PRINT "You have lost some of your";
20376 LOCATE 2,7:PRINT "possessions whilst fighting";
20377 LOCATE 10,9:PRINT "Your way out";
20380 DH=DH-FNRN(7):IF DH<=0 THEN DH=0
20381 BH=BH-FNRN(20):IF BH<=0 THEN BH=0
20382 UW=FNRN(4):IF UW<2 THEN CA=0 AND CL=0
20383 UX=FNRN(4):IF UX<2 THEN CJ=0 AND CB=0
20384 GOSUB 20750
20385 GOTO 21050
20455 IF DF=1 THEN 20000
20460 LOCATE 3,3:PRINT "The Cloak of Invisibility";
20465 GOSUB 21000
20466 IF NO=1 THEN 2075
20470 DF=1:GOTO 21050
20475 IF LX<>5 THEN 20000
20480 IF DI=1 THEN 20000
20485 LOCATE 6,3:PRINT "The Shield of Life";
20490 GOSUB 21000
20491 IF NO=1 THEN 2075
20495 DI=1:GOTO 21050
20500 IF LX<>4 THEN 20000
20505 IF DG=1 THEN 20000
20510 LOCATE 6,3:PRINT "The Ring of Power";
20515 GOSUB 21000
20516 IF NO=1 THEN 2075
20520 DG=1:GOTO 21050
20525 IF LX<>6 THEN 20000
20530 IF DD=1 THEN 20000
20535 LOCATE 6,3:PRINT "The Necromancers Map";
20540 GOSUB 21000
20541 IF NO=1 THEN 2075
20545 DD=1:GOTO 21050
20600 NO=0:A=INKEY(10) AND 223:IF A=0 THEN 20600
20610 IF A=ASC("Y") THEN 21045
20620 IF A=ASC("N") THEN NO=1:GOTO 21046
20630 GOTO 20600
20700 A=INKEY(10) AND 223:IF A=0 THEN 20700
20710 IF A=ASC("P") THEN RETURN
20720 GOTO 20700
20750 PAUSE 250
20755 RETURN
21000 LOCATE 9,9:PRINT "Do you take it?";:LOCATE 13,10:PRINT "Yes/No";
21010 GOTO 20600
21045 TX=1:BF=BF-3
21046 RETURN
21050 GOTO 2075
24014 NEXT J
24999 LOCATE 6,12:PRINT "Beware! You have met";
25010 RF=INT((RND(TI)*12)+1)
25080 XC$=RIGHT$(M$(RF),LEN(M$(RF))-1)
25090 LOCATE (32-LEN(XC$))#2,14:PRINT XC$;
25100 PAUSE 200
25110 LOCATE 0,12:PRINT " ":LOCATE 0,13:PRINT " ":LOCATE 0,14:PRINT " "
25120 ZB=INT(MS(RF)*D1)
25125 ZA=INT(BF*((BD*2)/100))
25126 XP=INT((ZB+1)/(ZA+1))*2
25200 IF RND(TI)<0.6 OR DF=1 THEN 25210:ELSE 25375
25205 DZ=0
25210 CLS:COLOR 15,6,6
25211 IF BE<=0 THEN 7000
25212 IF BF<=0 THEN BE=BE-BE
25215 DZ=DZ+((BD*(BF*.5))#100):IF DZ>25 THEN DZ=25
25220 T=0:DX=0:IF ZB<=0 THEN 25480
25221 CLS:COLOR 15,6,6
25222 LOCATE 5,4:PRINT "Attack or cast a Spell";
25223 KL=FNRN(10)-1
25224 LOCATE INT(RND(1)*32),INT(RND(1)*3):PRINT KL;
25225 A=INKEY(10)
25230 IF A=KL+48 THEN 25300
25240 A=A AND 223:IF A=ASC("S") THEN 29350
25250 T=T+1:IF T>25 THEN 25265
25260 GOTO 25225
25265 CLS:COLOR 15,6,6
25270 DX=5:LOCATE 12,6:PRINT "Too slow";:LOCATE 8,9:PRINT "You are wounded";
25280 GOSUB 25450
25281 IF BE<=0 THEN 7000
25282 IF BF<=0 THEN 9100
25283 IF ZA<=0 THEN 25510
25290 GOTO 6000
25300 CLS:COLOR 15,6,6
25310 IF T<8 THEN RF=1
25311 IF T>7 AND T<14 THEN RF=2
25312 IF T>13 AND T<19 THEN RF=3
25313 IF T>18 THEN 25265
25320 ON RF GOTO 25325,25340,25355
25325 DZ=INT((DZ+10)/(MS(RF)/10)):DX=0:LOCATE 9,6:PRINT "A mighty blow";:GOSUB 25450
25326 IF BE<=0 THEN 7000
25327 IF BF<=0 THEN 9100
25328 IF ZA<=0 THEN 25510
25335 GOTO 25210
25340 DZ=INT((DZ+8)/(MS(RF)/10)):DX=1:LOCATE 9,6:PRINT ,"A swift strike";
25345 GOSUB 25450
25346 IF BE<=0 THEN 7000
25347 IF BF<=0 THEN 9100
25348 IF ZA<=0 THEN 25510
25350 GOTO 25210
25355 DZ=INT((DZ+6)/(MS(RF)/10)):DX=2:LOCATE 9,6:PRINT "Half repelled";:GOSUB 25450
25356 IF BE<=0 THEN 7000
25357 IF BF<=0 THEN 9100
25358 IF ZA<=0 THEN 25510
25360 GOTO 25210
25375 CLS:COLOR 15,6,6
25380 LOCATE 5,4:PRINT "Surprise on your side";:DX=10:
25385 LOCATE 9,6:PRINT "Attack or Run!";:LOCATE 8,7:PRINT "or cast a Spell";
25390 A=INKEY(10) AND 223
25395 IF A=ASC("A") THEN 25300
25398 IF A=ASC("S") THEN 29350
25400 IF A=ASC("R") THEN 25420
25405 T=T+1:IF T>25 THEN 25265
25410 GOTO 25390
25420 RU=RND(TI):IF TI<0.5 THEN 25210
25425 CLS
25430 LOCATE 13,6:PRINT "Lucky";:LOCATE 9,7:PRINT "You escaped!";
25432 LOCATE 12,9:PRINT "You coward";
25433 PAUSE 100
25435 BD=BD-3
25440 GOTO 2950
25450 ZB=ZB-DZ:
25460 BE=BE-DX:BF=BF-(DX#2)
25470 PAUSE 250
25475 RETURN
25480 CLS:COLOR 15,6,6
25482 BD=BD+2+XP
25485 LOCATE 9,4:PRINT "We salute you";:LOCATE 11,6:PRINT "Pendragon";
25490 LOCATE 9,8:PRINT "Mighty Warrior";
25495 PAUSE 150
25500 GOTO 2950
25510 CLS:COLOR 15,6,6
25520 LOCATE 7,6:PRINT "Battle indecisive!";
25525 PAUSE 100:GOTO 2950
25530 PAUSE 80:GOTO 1000
25550 LOCATE 11,6:PRINT "Pendragon";:LOCATE 5,7:PRINT "on your way victorious";
25560 BF=BF+(ZX-ZA)
25570 PAUSE 80:RETURN
28000 CLS:COLOR 1,9,9
28010 LOCATE 7,7:PRINT "Too weak to attack";
28020 PAUSE 80:NEXT N
28030 LOCATE 8,8:PRINT "You are killed!!";
28040 PAUSE 80:NEXT N
28050 RUN
29350 CLS:COLOR 4,1,1
29360 IF BG>10 THEN 29600
29370 LOCATE 9,4:PRINT "Power too weak";
29380 PAUSE 80:MS=MS+10
29390 GOTO 25270
29500 CLS:FOR N=1 TO 8
29510 COLOR 15,N,N:GOSUB 29550
29520 NEXT N
29530 RETURN
29550 FOR X=1 TO 10
29560 X3=INT(RND(TI)*32):Y3=INT(RND(TI)*24)
29570 LOCATE X3,Y3:PRINT CHR$(255);
29580 NEXT X
29590 RETURN
29600 CLS:COLOR 1,7,7
29605 L1$="All hail Pendragon"
29610 LOCATE 10,0:PRINT "*Cast Spell*";
29620 GOSUB 51000
29630 IF SP<1 THEN 29992
29640 CLS:COLOR 1,7,7
29645 BG=INT(BG*0.9)-T:IF BG<=0 THEN BG=0
29646 BD=BD+(N1#5)
29650 LOCATE 6,10:PRINT L1$;
29660 FOR N=1 TO 25:SOUND 1,3500,4:PAUSE 5
29670 NEXT N
29680 GOTO 2000
29992 CLS:COLOR 1,7,7
29995 BG=INT(BG*0.75)-T:IF BG<=0 THEN BG=0
29997 GOTO 25210
30000 SCREEN 2:COLOR 11,12,12:CO=11
30010 P1$="BM0,154;E3F2E2F2E2F2E2F2E2F2R2H3U39G2L3G1L3G1L3G1L3G1L2R2E1R3E1R3E1"
30012 P1$=P1$+"R3E1R3E3R3E2R3E4R2E4R2E3U2H1U2H1U4H1U2H1U3H1U3"
30014 P2$="BM88,36;E4R2E6F2E6F3R2F5NG5E3R2E2R1F6NG8R1E2R1E2R4E1R3F1R1F2NG3E2R1"
30016 P2$=P2$+"E2R2E1R4F4NG4E1R2F1R1E1"
30025 DRAW 64,48,191,48,CO:DRAW 191,48,191,143,CO
30027 DRAW 191,143,64,143,CO:DRAW 64,143,64,48,CO
30030 ON LX GOTO 30100,30200,30300,30400,30500,30600,30700,30800,30900
30100 ZA$=P1$:GOSUB 53000
30110 ZA$=P2$:GOSUB 53000
30120 ZA$="BM72,54;F4R2F2R2F1R1F1R1F1R2F1R2F1R2F1R2F1R2F1R2F1R2F1R2F1R2F1R2F1"
30123 ZA$=ZA$+"R2F1R2F1R2F1R2F1R2F1R2F1R2F1R2F1R2F1R2F1R2F1R2F1R2F1R2F1R2F1R1"
30126 GOSUB 53000
30130 ZA$="BM40,86;R1F3R2F4R2F5R2F5R3F3R2F5R2F4R2F4R2F3D1F6D1F8"
30135 GOSUB 53000
30140 PAINT 70,98,8
30145 PAINT 124,52,7
30150 PAINT 134,98,4
30155 REM PAINT 4,180,11
30156 GPRINT "Press P",24,22
30160 GOSUB 20700
30165 D1=2
30170 GOTO 4000
30200 ZA$=P1$:GOSUB 53000
30220 ZA$="BM83,47;F4R2F1R2F2R3F1R2F1R2F1R2F1R2F1R2F1R2E1R2E1R2E1R2E1R2E1R2E1"
30225 ZA$=ZA$+"R2E1R2E4R1E1R1E2R1E2R1E2U3H1U2H2U3H2U3H2":GOSUB 53000
30230 ZA$="BM118,64;F3D1F1D1F1D37G4R3E3F3E3F3E3F3E4F4R3H4U39E1U2E1U1E1GD1F2R3"
30235 ZA$=ZA$+"F1R3F1R3E1R3E1R3U1R4":GOSUB 53000
30240 ZA$="BM192,68;F4D12G2R2E2F1R1E1F2R2H2U12E1U1E2U1R3F1R1F1D3F3D3F2D36G4R3E3F4"
30245 GOSUB 53000
30250 ZA$="BM202,48;F3R1F2R1F2R1F2R1F2R1F2R1F3R2F1R1":GOSUB 53000
30260 PAINT 72,98,8
30270 PAINT 140,98,8
30275 PAINT 167,88,8
30280 PAINT 190,104,8
30282 DRAW 64,138,191,138:PAINT 65,139,11
30283 GPRINT "Press P",24,22
30285 GOSUB 20700
30290 GOTO 4000
30300 ZA$="BM0,48;E13R2E2F2E5F5D2F1D2F3D3F3NG3E6R2E1R2E5F8R2F1R1F4R3F4NG6E14R1"
30305 ZA$=ZA$+"E7F8R2F1R2F1R2E1R2E11":GOSUB 53000
30310 ZA$="BM0,158;E1U2E6U1E3U1E1U1E1H2U2E4R1E2R3E1R3E2R1E2R1E2R1E1R1E1R2E5R1E1"
30313 ZA$=ZA$+"R1E1R1E5R1F1R2F1R3F1R2F1R2F4R1F1R1F1R1F4R1F1R1F1R1F1R1F1NG10E3R2"
30316 ZA$=ZA$+"E1R2E1R2E4R2E1R1E2R1F7NG5E3R2E1R2E2":GOSUB 53000
30320 ZA$="BM76,86;G10L1G2L1G2L4G2F3D2G1D2G1D2G2D3G1D2F5R2F1R2F1R2F2R2F3R2F4D1"
30325 GOSUB 53000
30330 ZA$="BM80,114;R8F3NL7D6L4U3L2D3NR1L2U6H3D6F3":GOSUB 53000
30350 PAINT 66,50,4
30360 PAINT 74,134,11
30365 PAINT 108,107,11
30370 PAINT 108,109,11
30375 PAINT 105,109,11
30376 GPRINT "Press P",24,22
30380 GOSUB 20700
30390 GOTO 4000
30400 SCREEN 1:GOTO 8300
30420 PAUSE 150:GOTO 4000
30500 SCREEN 1:GOTO 8400
30520 PAUSE 150:GOTO 4000
30600 ZA$="BM0,52;E1R2E2R2E4R2F7NG8E2R2E1R2E2R2E3R1E2R2E1R2E1R2E4F12NG5E5R3E4R3E6F4"
30605 GOSUB 53000:ZA$="BM0,72;F3R2F3R2F3R2F3":GOSUB 53000
30610 ZA$="BM0,90;F4R2F3R2F3R1F1H1L1H2R3F1R1F1R4F1R3F3R2F1R2F1R2F1R2F3G3D1G3D1G4"
30612 ZA$=ZA$+"F2D2F1R1F3R1F5R3F1R3F4":GOSUB 53000
30614 ZA$="BM16,102;R9F1R4F1R3F1R3F1R3F1R2F1R2F2R1F1R1F6D1G2F2R6F1R4F1R3F1R3F2R3"
30616 ZA$=ZA$+"9F3R3F1R2F1R3F1R2":GOSUB 53000
30620 ZA$="BM218,42;F2NF4D1ND52L3G1L3G1L4G1L3G1L2H1L3H1L4H1L3H1L3ND52L1NG3E19F16E2"
30622 ZA$=ZA$+"R2E3R2E4R2E3":GOSUB 53000
30625 ZA$="BM170,72;E2R2E1R6F1R2F2G2L2G1L6H1L2H2":GOSUB 53000
30630 PAINT 70,54,7
30635 PAINT 124,128,11
30640 REM PAINT 180,100,11
30642 REM PAINT 192,44,11
30645 PAINT 156,84,8
30646 GPRINT "Press P",24,22
30650 GOSUB 20700
30660 GOTO 8500
30665 PAUSE 150:GOTO 4000
30700 ZA$=P1$:GOSUB 53000
30710 ZA$="BM40,94;R21H5U13NR6D13L3NU12H5NU5F5R9NU12R4BU7U6R8D5L8BD7D1R14U11NR5"
30711 GOSUB 53000
30712 ZA$=ZA$+"U11NL14H8NL10F8D22L19F5R19D6L18F17R4H3U49E16NR47F16NR29G15NH16NR46"
30713 GOSUB 53000
30714 ZA$=ZA$+"D16BR15R22D17L21U17BL15L1D35NR46H3U35H11D35F11L4F14BL22L1H42L4"
30715 GOSUB 53000
30720 PAINT 74,98,8
30725 PAINT 100,98,11
30730 PAINT 124,50,7
30735 REM PAINT 100,46,11
30740 REM PAINT 78,64,8
30745 PAINT 114,79,4
30750 REM PAINT 200,12,11
30755 REM PAINT 164,24,11
30760 REM PAINT 220,44,11
30765 REM PAINT 140,56,11
30770 REM PAINT 200,80,11
30775 REM PAINT 144,100,8
30780 PAINT 172,106,4
30784 GPRINT "Press P",24,22
30785 GOSUB 20700
30790 GOTO 4000
30800 ZA$="BM0,66;F7NG3E4F6E2F4":GOSUB 53000
30810 ZA$="BM200,0;G4R7D41L7D3L7U3L7D3L7U3L7D3L7U3L7U15R7H5U4L7D3L7U3L7D3L7U3L7"
30815 ZA$=ZA$+"D4G5R7D38R5NG27NR20U12E5R11F5D12NF27R78":GOSUB 53000
30820 ZA$="BM44,118;G18R14":GOSUB 53000
30830 ZA$="BM118,154;R69":GOSUB 53000
30840 ZA$="BM119,90;E14F8NG3E14F1E4F2":GOSUB 53000
30850 PAINT 66,50,7
30855 REM PAINT 72,72,11
30860 PAINT 81,118,4
30865 PAINT 102,108,8
30870 PAINT 144,120,4
30875 REM PAINT 102,128,11
30876 GPRINT "Press P",24,22
30880 GOSUB 20700
30890 GOTO 8000
30900 GOTO 4000
40000 CLS:COLOR 11,1,1
40010 LOCATE 1,1:PRINT CHR$(135);:LOCATE 30,1:PRINT CHR$(136);
40015 LOCATE 1,19:PRINT CHR$(138);:LOCATE 30,19:PRINT CHR$(137);
40020 LOCATE 11,4:PRINT "PENDRAGON";:LOCATE 9,6:PRINT "Water of Life";
40025 LOCATE 15,10:PRINT "by";:LOCATE 9,12:PRINT "David Jenkins";
40030 LOCATE 5,15:PRINT "port to LM80C BASIC by";
40035 LOCATE 8,17:PRINT "Leonardo Miliani"
40040 PAUSE 200
40050 SREG 8,31:SREG 9,13:SREG 10,13:SREG 11,200:SREG 12,1:SREG 13,12
40055 SOUND 1,3675,0:PAUSE 200:SOUND 0:VOLUME 0,15
40060 RETURN
50010 DATA "BGiant Spider",20,0,"HLiving Dead",25,10,"GHunter",35,0
50020 DATA "GMercenary",40,0,"ATroll",40,5,"EDark Birds",30,15,"AGoblin",30,17
50030 DATA "ADwarfs of the Pit",35,15,"ESoldiers of the Mists",50,0,"CWraith",30,35
50040 DATA "ERider of the Night",50,40,"DWarlocks of the Eye",50,50
51000 SP=0:A4=0
51002 IF BG<25 THEN A4=18
51003 IF BG>24 AND BG<35 THEN A4=13
51004 IF BG>34 AND BG<45 THEN A4=8
51005 IF BG>44 THEN A4=4
51010 RE=INT(RND(TI)*A4)
51100 A2=LEN(W$(RE))
51110 A3=0
51140 FOR Y1=1 TO LEN(W$(RE))
51150 LOCATE Y1*2,9:PRINT "- "
51160 NEXT Y1
51170 T2=0
51175 IF N1(RF)>BG THEN T2=2
51180 LOCATE 0,10:PRINT "Spell!"
51190 LOCATE 0,11:PRINT " "
51200 F=0
51210 INPUT L$
51220 T2=T2+1
51230 IF T2=8 THEN 51500
51350 IF L$=W$(RE) THEN 51550
51360 FOR A=1 TO LEN(W$(RE))
51370 IF L$=MID$(W$(RE),A,1) THEN GOSUB 51440
51380 NEXT A
51385 IF A3=A2 THEN 51550
51390 IF F=1 THEN 51180
51400 LOCATE 0,11:PRINT "Wrong"
51410 PAUSE 50
51420 LOCATE 0,11:PRINT SPC(10)
51430 GOTO 51180
51440 LOCATE A*2,8:PRINT L$;
51441 A3=A3+1
51450 F=1
51460 RETURN
51470 DATA "Saucer","Linger","Colony","Beckon","Saunter","Lintle","Colour"
51475 DATA "Become","Sausage","Linctus"
51480 DATA "Column","Becalm","Favour","Linseed","Collide","Beaver","Colonel"
51485 DATA "Beauty"
51500 CLS:COLOR 15,8,8
51505 LOCATE 10,7:PRINT "Magic Fails!";
51510 PAUSE 150
51520 RETURN
51550 SP=1
51555 CLS:COLOR 4,1,1
51556 LOCATE 12,7:PRINT "SUCCESS!";
51557 PAUSE 150
51560 RETURN
52000 DATA "River","Forest","Mountains","Cave","Lake","Tower","Village"
52010 DATA "Castle","Greatwall"
52050 DATA "0","1","2","3","4","5","6","7","8","9"
52100 DATA 40,40,15,45,45,20,50,50,10,60,60,25,70,70,15
52990 REM **DRAW A PICTURE**
53000 SP=1:SX=0:SY=0:IF ZA$="" THEN RETURN
53010 IF SP>LEN(ZA$) THEN RETURN
53020 ZB$=MID$(ZA$,SP,1)
53022 IF ZB$<>"C" THEN 53030
53024 GOSUB 59000:CO=ZV:GOTO 53010
53025 REM 'B' MEANS NO DRAWING WHILE MOVING
53030 IF ZB$<>"B" THEN FL=0:GOTO 53050
53040 SP=SP+1:ZB$=MID$(ZA$,SP,1):FL=1:GOTO 53070
53045 REM 'N' MEANS REVERT THE CURSOR TO START
53050 IF ZB$<>"N" THEN RT=0:GOTO 53070
53060 SP=SP+1:ZB$=MID$(ZA$,SP,1):RT=1:GOTO 53070
53065 REM 'M' MEANS MOVE CURSOR TO X,Y
53070 IF ZB$<>"M" THEN 53130
53080 SP=SP+1:PV=INSTR(ZA$,";"):IF PV=0 THEN ZC$="NO ;":GOTO 53390
53090 ST$=MID$(ZA$,SP,PV-SP)
53100 VR=INSTR(ST$,","):IF VR=0 THEN ZC$="NO ,":GOTO 53390
53110 TX=VAL(LEFT$(ST$,VR-1))#2+64:TY=VAL(MID$(ST$,VR+1))#2+48
53120 SP=PV+1:RT=0:GOTO 53400
53130 ZC$=MID$(ZA$,SP,1):IF ZC$<"A" OR ZC$>"Z" THEN 53390
53140 SP=SP+1:SQ=SP+1
53150 IF SQ>LEN(ZA$) THEN 53170
53160 ZV$=MID$(ZA$,SQ,1):IF ZV$>="0" AND ZV$<="9" THEN SQ=SQ+1:GOTO 53160
53170 ZV=VAL(MID$(ZA$,SP,SQ-SP)):SP=SQ
53180 IF ZC$="D" THEN TX=SX:TY=SY+ZV:GOTO 53400
53190 IF ZC$="U" THEN TX=SX:TY=SY-ZV:GOTO 53400
53200 IF ZC$="R" THEN TX=SX+ZV:TY=SY:GOTO 53400
53210 IF ZC$="L" THEN TX=SX-ZV:TY=SY:GOTO 53400
53220 IF ZC$="E" THEN TX=SX+ZV:TY=SY-ZV:GOTO 53400
53230 IF ZC$="F" THEN TX=SX+ZV:TY=SY+ZV:GOTO 53400
53240 IF ZC$="G" THEN TX=SX-ZV:TY=SY+ZV:GOTO 53400
53250 IF ZC$="H" THEN TX=SX-ZV:TY=SY-ZV:GOTO 53400
53390 A$="UNKNOWN GRAPHICS COMMAND "+ZC$:GOTO 59050
53400 IF TX<64 THEN TX=0
53410 IF TX>191 THEN TX=191
53420 IF TY<48 THEN TY=48
53430 IF TY>143 THEN TY=143
53440 IF FL=0 THEN DRAW SX,SY,TX,TY,CO
53450 IF RT=0 THEN SX=TX:SY=TY
53460 GOTO 53010
54990 REM **PENDRAGON**
55000 X$=MID$(STR$(X),2):Y$=MID$(STR$(Y),2)
55010 ZA$="BM"+X$+","+Y$+";D1F1D1L3ND2R2D3G1ND5E1R1NU2R1F1ND5H1U3R2ND2L3U1E1U1L1"
55020 CO=1:GOSUB 53000
55030 RETURN
55900 DATA 2323,2426,2517,2619,2691,2771,2843,2920,2988,3048,3111,3159
55910 DATA 3216,3267,3312,3357,3397,3437,3473,3508,3542,3572,3601,3629
55920 DATA 3656,3680,3704,3725,3746,3765,3784,3802,3818,3834,3848,3862
55930 DATA 3875,3888,3899,3910,3921,3930,3940,3949,3957,3965,3972,3979
55940 DATA 3985,3992,3997,4003,4008,4013,4018,4022,4026,4030,4034,4037
55950 DATA "C","C+","D","E-","E","F","F+","G","A-","A","B-","B"
55990 REM ** PLAY A MUSIC **
56000 SP=1:OT=2:TM=2:LN=4
56010 IF SP>LEN(ZA$) THEN SOUND 1,0,0:RETURN
56020 ZB$=MID$(ZA$,SP,1)
56030 IF ZB$>="A" AND ZB$<="G" THEN 56130
56040 IF ZB$<>"V" THEN 56060
56050 GOSUB 59000:ZV=9+(ZV#5):VOLUME 0,ZV:GOTO 56010
56060 IF ZB$<>"T" THEN 56080
56070 GOSUB 59000:TM=ZV:GOTO 56010
56080 IF ZB$<>"O" THEN 56100
56090 GOSUB 59000:OT=ZV:GOTO 56010
56100 IF ZB$<>"L" THEN 56120
56110 GOSUB 59000:LN=ZV:GOTO 56010
56120 A$="UNKNOWN SOUND COMMAND "+ZB$:GOTO 59050
56130 ZC$=MID$(ZA$,SP+1,1)
56140 IF ZC$<>"+" AND ZC$<>"-" THEN 56160
56150 ZB$=ZB$+ZC$:SP=SP+1
56160 I=1
56170 IF NT$(I)=ZB$ THEN 56190
56175 I=I+1:IF I<13 THEN 56170
56180 A$="UNKNOWN NOTE "+ZB$:GOTO 59050
56190 FR=NE(OT,I):DU=INT(((2/TM)*100)*(4/LN))
56200 SOUND 1,FR,DU:PAUSE DU+4
56210 SP=SP+1:GOTO 56010
58990 REM READ A NUMBER FROM A STRING
59000 SP=SP+1:SQ=SP
59010 IF SQ>LEN(ZA$) THEN 59030
59020 ZV$=MID$(ZA$,SQ,1):IF ZV$>="0" AND ZV$<="9" THEN SQ=SQ+1:GOTO 59010
59030 ZV=VAL(MID$(ZA$,SP,SQ-SP)):SP=SQ
59040 RETURN
59050 SCREEN 1:SOUND 0:PRINT A$
59060 STOP
